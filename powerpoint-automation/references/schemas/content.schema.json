{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "https://github.com/aktsmm/Agent-Skills/tree/main/powerpoint-automation/references/schemas/content.schema.json",
  "version": "1.0.0",
  "title": "PPTX Content IR Schema",
  "description": "Intermediate Representation (IR) schema for PPTX generation workflow",
  "type": "object",
  "required": ["slides"],
  "properties": {
    "title": {
      "type": "string",
      "description": "Presentation title"
    },
    "subtitle": {
      "type": "string",
      "description": "Presentation subtitle"
    },
    "schema_version": {
      "type": "string",
      "description": "Schema version for compatibility check",
      "default": "1.0.0"
    },
    "slides": {
      "type": "array",
      "description": "Array of slide definitions",
      "minItems": 1,
      "items": {
        "$ref": "#/definitions/slide"
      }
    }
  },
  "definitions": {
    "slide": {
      "type": "object",
      "required": ["type"],
      "properties": {
        "type": {
          "type": "string",
          "enum": [
            "title",
            "section",
            "agenda",
            "content",
            "two_column",
            "photo",
            "summary",
            "closing",
            "code",
            "blank"
          ],
          "description": "Slide layout type"
        },
        "title": {
          "type": "string",
          "description": "Slide title text"
        },
        "subtitle": {
          "type": "string",
          "description": "Slide subtitle text"
        },
        "items": {
          "type": "array",
          "items": {
            "type": "string",
            "minLength": 1
          },
          "description": "Bullet point items"
        },
        "left_items": {
          "type": "array",
          "items": { "type": "string" },
          "description": "Left column items for two_column type"
        },
        "left_title": {
          "type": "string",
          "description": "Left column title for two_column type"
        },
        "right_items": {
          "type": "array",
          "items": { "type": "string" },
          "description": "Right column items for two_column type"
        },
        "right_title": {
          "type": "string",
          "description": "Right column title for two_column type"
        },
        "notes": {
          "type": "string",
          "description": "Speaker notes"
        },
        "image": {
          "$ref": "#/definitions/image"
        },
        "code": {
          "type": "string",
          "description": "Code block content for code type slides"
        },
        "language": {
          "type": "string",
          "description": "Programming language for code highlighting"
        },
        "_source": {
          "$ref": "#/definitions/source"
        },
        "_skip": {
          "type": "boolean",
          "description": "Flag to skip this slide during processing"
        },
        "_reason": {
          "type": "string",
          "description": "Reason for skipping the slide"
        }
      },
      "allOf": [
        {
          "if": {
            "properties": { "type": { "const": "title" } }
          },
          "then": {
            "required": ["title"]
          }
        },
        {
          "if": {
            "properties": { "type": { "const": "section" } }
          },
          "then": {
            "required": ["title"]
          }
        },
        {
          "if": {
            "properties": { "type": { "const": "content" } }
          },
          "then": {
            "anyOf": [{ "required": ["items"] }, { "required": ["image"] }]
          }
        },
        {
          "if": {
            "properties": { "type": { "const": "agenda" } }
          },
          "then": {
            "required": ["items"]
          }
        },
        {
          "if": {
            "properties": { "type": { "const": "summary" } }
          },
          "then": {
            "required": ["items"]
          }
        },
        {
          "if": {
            "properties": { "type": { "const": "two_column" } }
          },
          "then": {
            "anyOf": [
              { "required": ["items"] },
              {
                "required": ["left_items", "right_items"]
              }
            ]
          }
        },
        {
          "if": {
            "properties": { "type": { "const": "photo" } }
          },
          "then": {
            "required": ["image"]
          }
        },
        {
          "if": {
            "properties": { "type": { "const": "code" } }
          },
          "then": {
            "required": ["code"]
          }
        }
      ]
    },
    "image": {
      "type": "object",
      "description": "Image configuration for the slide",
      "properties": {
        "path": {
          "type": "string",
          "description": "Local file path to the image"
        },
        "url": {
          "type": "string",
          "format": "uri",
          "description": "Remote URL to fetch the image from"
        },
        "position": {
          "type": "string",
          "enum": ["right", "left", "bottom", "center", "full"],
          "default": "right",
          "description": "Image position on the slide"
        },
        "width_percent": {
          "type": "number",
          "minimum": 10,
          "maximum": 100,
          "description": "Image width as percentage of slide width"
        },
        "height_percent": {
          "type": "number",
          "minimum": 10,
          "maximum": 100,
          "description": "Image height as percentage of slide height"
        },
        "alt": {
          "type": "string",
          "description": "Alternative text for the image"
        }
      },
      "oneOf": [{ "required": ["path"] }, { "required": ["url"] }]
    },
    "source": {
      "type": "object",
      "description": "Source tracking information from original PPTX",
      "properties": {
        "original_index": {
          "type": "integer",
          "minimum": 0,
          "description": "Original slide index (0-based)"
        },
        "original_layout": {
          "type": "string",
          "description": "Original slide layout name"
        },
        "has_chart": {
          "type": "boolean",
          "description": "Whether the original slide had a chart"
        },
        "has_table": {
          "type": "boolean",
          "description": "Whether the original slide had a table"
        },
        "has_diagram": {
          "type": "boolean",
          "description": "Whether the original slide had a diagram"
        }
      }
    }
  }
}
